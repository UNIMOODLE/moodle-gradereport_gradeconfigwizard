define("gradereport_gradeconfigwizard/multipleevaluations",["exports","jquery"],(function(_exports,_jquery){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};let multipleevaluationtablebody=document.getElementById("multipleevaluation-table").getElementsByTagName("tbody")[0],addcategorybtn=document.getElementById("multipleevaluations-category-create-btn"),gradeitemsmodal=document.querySelector("#available-gradeitems-modal-id"),gradeitemsmodalacceptbutton=gradeitemsmodal.querySelector(".confirm");const removeGradeitemsmodalItems=gradeitems=>{gradeitems.forEach((gradeitem=>{gradeitem.closest("div").classList.add("d-none"),gradeitem.checked=!1}))},addGradeitemsmodalItem=gradeitemid=>{let gradeitem=gradeitemsmodal.querySelector('[data-id="'+gradeitemid+'"]');gradeitem.closest("div").classList.remove("d-none"),gradeitem.checked=!1},recalculateRowspans=randomid=>{var totalItemCount=multipleevaluationtablebody.querySelectorAll('[data-randomid="'+randomid+'"][data-rowtype="categorygradeitemaddbtn"]').length+multipleevaluationtablebody.querySelectorAll('[data-randomid="'+randomid+'"][data-rowtype="categorygradeitem"]').length+1;multipleevaluationtablebody.querySelectorAll('[data-randomid="'+randomid+'"][data-rowtype="category"] td').forEach((datacell=>{datacell.rowSpan=totalItemCount}))},addCategory=categoryname=>{let randomid=(()=>{let randomid=null;for(;null===randomid||null!==document.getElementById(randomid);)randomid=Math.random().toString(36).substring(2,10);return randomid})(),newcategoryrow=document.createElement("tr");newcategoryrow.id=randomid,newcategoryrow.dataset.randomid=randomid,newcategoryrow.dataset.depthlevel=1,newcategoryrow.dataset.rowtype="category";let newcategorycell=document.createElement("td");newcategorycell.classList.add("category"),newcategorycell.rowSpan=2,newcategorycell.innerHTML=((randomid,categoryname)=>"\n".concat(categoryname,'\n<input name="categories[').concat(randomid,'][name]" type="hidden" value="').concat(categoryname,'"/>\n'))(randomid,categoryname)+(randomid=>'\n<i class="fa fa-fw fa-trash-o icon remove-item-icon" data-randomid="'.concat(randomid,'" \ntitle="Remove element" role="img" aria-label="Remove element"></i>\n'))(randomid),newcategoryrow.appendChild(newcategorycell),newcategoryrow.innerHTML+=(randomid=>'\n<td class="weight-1" rowspan="2">\n  <input type="number" name="categories['.concat(randomid,'][weight]" size="2" value="1">\n</td>\n<td class="min-grade-1" rowspan="2">\n  <div class="container">\n    <div class="row">\n      <input type="checkbox" class="mr-2" id="myCheckbox" disabled>\n      <input type="number" name="categories[').concat(randomid,'][recitem][recitemgrade]" size="2" disabled>\n    </div>\n  </td>\n  </div>\n<td class="resit-1 add-btn" rowspan="2">\n  <button type="button"\n    class="add-resit-items-btn btn btn-secondary"\n    data-toggle="modal"\n    data-target="#available-gradeitems-modal-id"\n    data-gradeitemaddtarget="categoryresititem"\n    data-addgradeitemdepth="1" disabled>\n      Añadir elemento\n  </button>\n</td>\n'))(randomid),multipleevaluationtablebody.appendChild(newcategoryrow),newcategoryrow.insertAdjacentHTML("afterend",(randomid=>'\n<tr data-randomid="'.concat(randomid,'" data-rowtype="categorygradeitemaddbtn" data-depthlevel="2">\n  <td class="item">\n    <button type="button"\n      data-toggle="modal"\n      data-target="#available-gradeitems-modal-id"\n      data-gradeitemaddtarget="gradeitem"\n      data-addgradeitemdepth="2"\n      class="add-category-items-btn btn btn-secondary">\n        Añadir elementos\n    </button>\n  </td>\n  <td class="weight-2"></td>\n  <td class="min-grade-2"></td>\n  <td class="resit-2"></td>\n</tr>\n'))(randomid)),newcategoryrow.querySelector(".remove-item-icon").addEventListener("click",removeCategoryCallback),newcategoryrow.querySelector('.min-grade-1 input[type="checkbox"]').addEventListener("change",categoryMinGradeCheckboxChangeCallback),newcategoryrow.querySelector('.min-grade-1 input[type="number"]').addEventListener("input",categoryMinGradeTextChangeCallback)},addCategoryGradeitem=(randomid,gradeitem)=>{let gradeitemid=gradeitem.dataset.id,gradeitemname=gradeitem.dataset.displayname;multipleevaluationtablebody.querySelectorAll('[data-randomid="'+randomid+'"][data-rowtype="categorygradeitemaddbtn"]')[0].insertAdjacentHTML("beforebegin",((randomid,gradeitemid,gradeitemname)=>'\n<tr data-randomid="'.concat(randomid,'" data-rowtype="categorygradeitem" data-gradeitemid="').concat(gradeitemid,'" data-depthlevel="2">\n  <td class="item"\n    data-gradeitemid="').concat(gradeitemid,'"\n    data-gradeitemname="').concat(gradeitemname,'"\n    >\n      ').concat(gradeitemname,'\n      <input name="categories[').concat(randomid,"][items][").concat(gradeitemid,'][id]" type="hidden" value="').concat(gradeitemid,'" />\n      <i class="fa fa-fw fa-trash-o icon remove-item-icon" data-randomid="').concat(randomid,'" data-gradeitemid="').concat(gradeitemid,'" \n      title="Remove element" role="img" aria-label="Remove element"></i>\n  </td>\n  <td class="weight-2">\n    <input type="number" name="categories[').concat(randomid,"][items][").concat(gradeitemid,'][weight]" size="2" value="1" />\n  </td>\n  <td class="min-grade-2">\n    <div class="container">\n      <div class="row">\n        <input type="checkbox" class="mr-2">\n        <input name="categories[').concat(randomid,"][items][").concat(gradeitemid,'][recitem][recitemgrade]" type="number" size="2" disabled>\n      </div>\n    </div>\n  </td>\n  <td class="resit-2" data-gradeitemid="').concat(gradeitemid,'">\n    <button type="button"\n      class="add-grade-item-resit-items-btn btn btn-secondary"\n      data-gradeitemaddtarget="gradeitemresititem"\n      data-toggle="modal"\n      data-target="#available-gradeitems-modal-id"\n      disabled>\n        Añadir elemento\n    </button>\n  </td>\n</tr>\n'))(randomid,gradeitemid,gradeitemname));let newcategorygradeitemrow=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="categorygradeitem"][data-gradeitemid="'+gradeitemid+'"]');newcategorygradeitemrow.querySelector(".remove-item-icon").addEventListener("click",removeCategoryGradeItemCallback),newcategorygradeitemrow.querySelector('.min-grade-2 input[type="checkbox"]').addEventListener("change",categoryGradeitemMinGradeCheckboxChangeCallback),newcategorygradeitemrow.querySelector('.min-grade-2 input[type="number"]').addEventListener("input",categoryGradeitemMinGradeTextChangeCallback),multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="category"] .min-grade-1 input[type="checkbox"]').disabled=!1,recalculateRowspans(randomid)},removeCategoryGradeitem=(randomid,gradeitemid)=>{multipleevaluationtablebody.querySelectorAll('tr[data-randomid="'+randomid+'"][data-rowtype="categorygradeitem"][data-gradeitemid="'+gradeitemid+'"]').forEach((row=>{row.querySelectorAll("[data-gradeitemid]").forEach((row=>addGradeitemsmodalItem(row.dataset.gradeitemid))),row.remove()}));let categorygradeitems=multipleevaluationtablebody.querySelectorAll('tr[data-randomid="'+randomid+'"][data-rowtype="categorygradeitem"]'),categorymingradecheckbox=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="category"] .min-grade-1 input[type="checkbox"]');categorygradeitems.length>0?categorymingradecheckbox.disabled=!1:categorymingradecheckbox.disabled=!0,addGradeitemsmodalItem(gradeitemid),recalculateRowspans(randomid)},removeCategoryResititem=function(randomid){let gradeitemid=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,categoryresitgradeitem=null;null===gradeitemid?(categoryresitgradeitem=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"] td.resit-1'),gradeitemid=categoryresitgradeitem.dataset.gradeitemid):categoryresitgradeitem=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"] td.resit-1[data-gradeitemid="'+gradeitemid+'"]');let categoryresitgradeitemcell=categoryresitgradeitem.closest("td");categoryresitgradeitemcell.insertAdjacentHTML("afterend",(randomid=>'\n<td class="resit-1 add-btn" rowspan="2" id="categoryresitbutton-'.concat(randomid,'">\n  <button type="button"\n    class="add-resit-items-btn btn btn-secondary"\n    data-toggle="modal"\n    data-target="#available-gradeitems-modal-id"\n    data-gradeitemaddtarget="categoryresititem"\n    data-addgradeitemdepth="1">\n      Añadir elemento\n  </button>\n</td>\n'))(randomid)),categoryresitgradeitemcell.remove(),void 0!==gradeitemid&&addGradeitemsmodalItem(gradeitemid),recalculateRowspans(randomid)},removeCategoryGradeitemResititem=(randomid,parentgradeitemid,gradeitemid)=>{let categoryresitgradeitemcell=multipleevaluationtablebody.querySelector('td.resit-2[data-gradeitemid="'+gradeitemid+'"]');categoryresitgradeitemcell.insertAdjacentHTML("afterend",(gradeitemid=>'\n<td class="resit-2 add-btn" data-gradeitemid="'.concat(gradeitemid,'">\n  <button type="button"\n    class="add-grade-item-resit-items-btn btn btn-secondary"\n    data-gradeitemaddtarget="gradeitemresititem"\n    data-toggle="modal"\n    data-target="#available-gradeitems-modal-id">\n      Añadir elemento\n  </button>\n</td>\n'))(parentgradeitemid)),categoryresitgradeitemcell.remove(),parentgradeitemid!=gradeitemid&&addGradeitemsmodalItem(gradeitemid),recalculateRowspans(randomid)},addCategoryButtonClickCallback=()=>{let categorynameinput=document.getElementById("multipleevaluations-category-create-name");categorynameinput.value=categorynameinput.value.trim();let categoryname=categorynameinput.value;""!==categoryname&&(addCategory(categoryname),categorynameinput.value="")},removeCategoryCallback=event=>{(randomid=>{removeCategoryResititem(randomid),multipleevaluationtablebody.querySelectorAll('tr[data-rowtype="categorygradeitem"][data-randomid="'+randomid+'"]').forEach((catgorygradeitemrow=>{let randomid=catgorygradeitemrow.dataset.randomid,gradeitemid=catgorygradeitemrow.dataset.gradeitemid;removeCategoryGradeitem(randomid,gradeitemid)})),multipleevaluationtablebody.querySelectorAll('tr[data-randomid="'+randomid+'"]').forEach((row=>row.remove()))})(event.target.dataset.randomid)},removeCategoryGradeItemCallback=event=>{let randomid=event.target.dataset.randomid,gradeitemid=event.target.dataset.gradeitemid;removeCategoryGradeitem(randomid,gradeitemid)},removeCategoryResitGradeitemCallback=event=>{let parenttd=event.target.closest("td"),randomid=parenttd.closest("tr").dataset.randomid,gradeitemid=parenttd.dataset.gradeitemid;removeCategoryResititem(randomid,gradeitemid)},removeCategoryGradeitemResitGradeitemCallback=event=>{let parenttd=event.target.closest("td"),parenttr=parenttd.closest("tr"),randomid=parenttr.dataset.randomid,gradeitemid=parenttd.dataset.gradeitemid,parentgradeitemid=parenttr.querySelector("td.item").dataset.gradeitemid;removeCategoryGradeitemResititem(randomid,parentgradeitemid,gradeitemid)},availableGradeItemsModalShowCallback=event=>{let button=event.relatedTarget,callerrandomid=button.closest("tr").dataset.randomid,gradeitemaddtarget=button.dataset.gradeitemaddtarget,addgradeitemdepth=button.dataset.addgradeitemdepth,gradeitemid=button.closest("td").dataset.gradeitemid;gradeitemsmodal.dataset.gradeitemaddtarget=gradeitemaddtarget,gradeitemsmodal.dataset.addgradeitemdepth=addgradeitemdepth,gradeitemsmodal.dataset.callerrandomid=callerrandomid,gradeitemsmodal.dataset.gradeitemid=gradeitemid},availableGradeItemsModalConfirmCallback=()=>{let gradeitemaddtarget=gradeitemsmodal.dataset.gradeitemaddtarget,gradeitemid=gradeitemsmodal.dataset.gradeitemid,randomid=gradeitemsmodal.dataset.callerrandomid,gradeitems=gradeitemsmodal.querySelectorAll('input[type="checkbox"]:checked:not(.d-none)');switch(gradeitemaddtarget){case"gradeitem":((randomid,gradeitems)=>{gradeitems.forEach((gradeitem=>{addCategoryGradeitem(randomid,gradeitem)}))})(randomid,gradeitems),removeGradeitemsmodalItems(gradeitems),(0,_jquery.default)(gradeitemsmodal).modal("hide");break;case"categoryresititem":if(gradeitems.length>1){alert("Selecciona solo 1 gradeitem");break}((randomid,gradeitem)=>{let gradeitemid=gradeitem.dataset.id,gradeitemname=gradeitem.dataset.displayname,rowspan=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="category"] td.resit-1').getAttribute("rowspan"),categoryresitgradeitemcell=multipleevaluationtablebody.querySelector('[data-randomid="'+randomid+'"] td.resit-1 .add-resit-items-btn').closest("td");categoryresitgradeitemcell.insertAdjacentHTML("beforebegin",((randomid,gradeitemid,gradeitemname,rowspan)=>'\n<td class="resit-1" rowspan="'.concat(rowspan,'" data-gradeitemid="').concat(gradeitemid,'" data-gradeitemname="').concat(gradeitemname,'">\n  ').concat(gradeitemname,'\n  <input name="categories[').concat(randomid,'][recitem][recitemid]" type="hidden" value="').concat(gradeitemid,'"/>\n  <i class="fa fa-fw fa-trash-o icon remove-item-icon" title="Remove element" role="img" aria-label="Remove element"></i>\n</td>\n'))(randomid,gradeitemid,gradeitemname,rowspan)),categoryresitgradeitemcell.remove(),multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="category"] td.resit-1[data-gradeitemid="'+gradeitemid+'"]').querySelector(".remove-item-icon").addEventListener("click",removeCategoryResitGradeitemCallback)})(randomid,gradeitems[0]),removeGradeitemsmodalItems(gradeitems),(0,_jquery.default)(gradeitemsmodal).modal("hide");break;case"gradeitemresititem":if(gradeitems.length>1){alert("Selecciona solo 1 gradeitem");break}((randomid,parentgradeitem,gradeitem)=>{let gradeitemid=gradeitem.dataset.id,gradeitemname=gradeitem.dataset.displayname,categorygradeitemresitgradeitemcell=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"] td[data-gradeitemid="'+parentgradeitem+'"] ~ td.resit-2 .add-grade-item-resit-items-btn').closest("td");categorygradeitemresitgradeitemcell.insertAdjacentHTML("beforebegin",((randomid,gradeitemid,gradeitemname,parentgradeitemid)=>'\n<td class="resit-2" data-gradeitemid="'.concat(gradeitemid,'" data-gradeitemname="').concat(gradeitemname,'">\n  ').concat(gradeitemname,'\n  <input name="categories[').concat(randomid,"][items][").concat(parentgradeitemid,'][recitem][recitemid]" type="hidden" value="').concat(gradeitemid,'" />\n  <i class="fa fa-fw fa-trash-o icon remove-item-icon" title="Remove element" role="img" aria-label="Remove element"></i>\n</td>\n'))(randomid,gradeitemid,gradeitemname,parentgradeitem)),categorygradeitemresitgradeitemcell.remove(),multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"][data-rowtype="categorygradeitem"] td.resit-2[data-gradeitemid="'+gradeitemid+'"]').querySelector(".remove-item-icon").addEventListener("click",removeCategoryGradeitemResitGradeitemCallback)})(randomid,gradeitemid,gradeitems[0]),removeGradeitemsmodalItems(gradeitems),(0,_jquery.default)(gradeitemsmodal).modal("hide")}},categoryMinGradeCheckboxChangeCallback=event=>{let categorymingradecheckbox=event.target,categorymingradecheckboxrow=categorymingradecheckbox.closest("tr"),randomid=categorymingradecheckboxrow.dataset.randomid,categoryresititemid=categorymingradecheckboxrow.querySelector(".resit-1").dataset.gradeitemid;categoryresititemid&&(removeCategoryResititem(randomid,categoryresititemid),(randomid=>{let addcategoryresititmebtn=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"] td.resit-1.add-btn button');addcategoryresititmebtn&&(addcategoryresititmebtn.disabled=!0)})(randomid));let categorymingradeinput=categorymingradecheckboxrow.querySelector('.min-grade-1 input[type="number"]');categorymingradecheckbox.checked?categorymingradeinput.disabled=!1:(categorymingradeinput.disabled=!0,categorymingradeinput.value="")},categoryGradeitemMinGradeCheckboxChangeCallback=event=>{let categorymingradecheckbox=event.target,categorygradeitemchangedrow=categorymingradecheckbox.closest("tr"),randomid=categorygradeitemchangedrow.dataset.randomid,parentgradeitemid=categorygradeitemchangedrow.querySelector("td.item").dataset.gradeitemid,resitgradeitemid=categorygradeitemchangedrow.querySelector("td.resit-2").dataset.gradeitemid;null!==resitgradeitemid&&null!==parentgradeitemid&&(removeCategoryGradeitemResititem(randomid,parentgradeitemid,resitgradeitemid),(randomid=>{let addcategorygradeitemresititembtn=multipleevaluationtablebody.querySelector('tr[data-randomid="'+randomid+'"] td.resit-2.add-btn button.add-grade-item-resit-items-btn');addcategorygradeitemresititembtn&&(addcategorygradeitemresititembtn.disabled=!0)})(randomid));let categorymingradeinput=categorygradeitemchangedrow.querySelector('.min-grade-2 input[type="number"]');categorymingradecheckbox.checked?categorymingradeinput.disabled=!1:(categorymingradeinput.disabled=!0,categorymingradeinput.value="")},categoryMinGradeTextChangeCallback=event=>{let mingradetextfield=event.target,addCategoryGradeitemResititemBtn=mingradetextfield.closest("tr").querySelector(".resit-1 button");""===mingradetextfield.value.trim()?addCategoryGradeitemResititemBtn.disabled=!0:addCategoryGradeitemResititemBtn.disabled=!1},categoryGradeitemMinGradeTextChangeCallback=event=>{let mingradetextfield=event.target,addCategoryGradeitemResititemBtn=mingradetextfield.closest("tr").querySelector(".resit-2 button");""===mingradetextfield.value.trim()?addCategoryGradeitemResititemBtn.disabled=!0:addCategoryGradeitemResititemBtn.disabled=!1};_exports.init=()=>{addcategorybtn.addEventListener("click",addCategoryButtonClickCallback),(0,_jquery.default)(gradeitemsmodal).on("show.bs.modal",availableGradeItemsModalShowCallback),gradeitemsmodalacceptbutton.addEventListener("click",availableGradeItemsModalConfirmCallback)}}));

//# sourceMappingURL=multipleevaluations.min.js.map