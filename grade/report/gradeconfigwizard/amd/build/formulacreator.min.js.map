{"version":3,"file":"formulacreator.min.js","sources":["../src/formulacreator.js"],"sourcesContent":["/* START: VARIABLES */\n\n// Obtener los items seleccionados\nlet selecteditemscheckboxes = document.querySelectorAll('.formulacreator-select-items input[type=checkbox]');\n\nlet aggregationmethoddiv = document.querySelector('.formulacreator-aggregation-method');\nlet weightsdefinitiondiv = document.querySelector('.formulacreator-weights-definition');\nlet weightsdefinitiontable = document.querySelector('.formulacreator-weights-definition table tbody');\nlet aggregationmethodselect = document.querySelector('.formulacreator-aggregation-method select');\n\n\nlet formulapreviewbox = document.querySelector('.formulacreator-formula');\nlet formulapreviewtextarea = document.querySelector('.formulacreator-formula textarea');\nlet previewformulabutton = document.getElementById('formulacreator-preview-formula');\n\n/* END: VARIABLES */\n\n/* START: FUNCTIONS */\n\nconst addEventToCheckbox = () => {\n    // Agregar evento change a cada checkbox de select-items\n    for (let i = 0; i < selecteditemscheckboxes.length; i++) {\n        selecteditemscheckboxes[i].addEventListener('change', function() {\n\n            // START: Habilitar aggregation methods\n\n            // Verificar si al menos 1 checkbox está marcado\n            let alMenosUnoMarcado = false;\n            for (let j = 0; j < selecteditemscheckboxes.length; j++) {\n                if (selecteditemscheckboxes[j].checked) {\n                    alMenosUnoMarcado = true;\n                    break;\n                }\n            }\n            // Habilitar o deshabilitar aggregation method selector según corresponda\n            if (alMenosUnoMarcado) {\n                aggregationmethoddiv.classList.remove(\"disabled-box\");\n                if (aggregationmethodselect.value !== \"0\") {\n                    weightsdefinitiondiv.classList.remove(\"disabled-box\");\n                }\n            } else {\n                aggregationmethoddiv.classList.add(\"disabled-box\");\n                // if (aggregationmethodselect.value === \"0\") {\n                weightsdefinitiondiv.classList.add(\"disabled-box\");\n                // }\n            }\n\n            // END: Habilitar aggregation methods\n\n            // START: Añadir elementos a weights definition\n            let weightenabled = '';\n            if (this.checked) {\n                if (aggregationmethodselect.value === 'weightedmeangrades') {\n                    weightenabled = '1';\n                } else {\n                    weightenabled = '0';\n                }\n\n                let newrow = weightsdefinitiontable.insertRow(-1);\n                newrow.innerHTML = '<th scope=\"row\">' +\n                    this.dataset.displayname +\n                    '</th>' +\n                    '<td>' +\n                    '<input type=\"text\"' +\n                    ' data-enabled=\"' + weightenabled + '\"' +\n                    ' data-itemdisplayname=\"' + this.dataset.displayname + '\"' +\n                    ' data-itemidnumber=\"' + this.dataset.idnumber + '\"' +\n                    ' data-itemid=\"' + this.dataset.id + '\"' +\n                    ' data-paramtype=\"weight\"' +\n                    ' class=\"form-control\" placeholder=\"\">' +\n                    '</td>';\n\n                newrow.dataset.id = this.dataset.id;\n            } else {\n                let weightsdefinitionmatchingrow = weightsdefinitiontable.querySelector('[data-id=\"' + this.dataset.id + '\"]');\n                if (weightsdefinitionmatchingrow) {\n                    weightsdefinitionmatchingrow.remove();\n                }\n            }\n\n            // END: Añadir elementos a weights definition\n        });\n    }\n};\n\nconst aggregationSelection = () => {\n    aggregationmethodselect.addEventListener('change', function() {\n        if (this.value === \"0\") {\n            weightsdefinitiondiv.classList.add(\"disabled-box\");\n        } else {\n            weightsdefinitiondiv.classList.remove(\"disabled-box\");\n        }\n        let weightitems = weightsdefinitiondiv.querySelectorAll('[data-paramtype=\"weight\"]');\n\n        switch (this.value) {\n            case 'weightedmeangrades':\n                weightitems.forEach(function(weightitem) {\n                    weightitem.dataset.enabled = 1;\n                    weightitem.classList.remove(\"disabled-box\");\n                });\n                break;\n            case 'meangrades':\n            case 'sum':\n            case 'highest':\n            case 'lowest':\n                weightitems.forEach(function(weightitem) {\n                    weightitem.dataset.enabled = 0;\n                    weightitem.classList.add(\"disabled-box\");\n                });\n                break;\n        }\n\n    });\n};\n\nconst previewFormula = () => {\n\n    previewformulabutton.addEventListener('click', function() {\n\n        formulapreviewbox.classList.remove(\"disabled-box\");\n\n        let selectedformulaitems = weightsdefinitiontable.querySelectorAll('[data-paramtype=\"weight\"]');\n        let itemsformula = '';\n\n        selectedformulaitems.forEach(function (selectedformulaitem) {\n            let itemformula = \"\";\n            itemformula = \"  <ITEM>\";\n\n            itemformula += \"<DISPLAYNAME>\" + selectedformulaitem.dataset.itemdisplayname + \"</DISPLAYNAME>\";\n            itemformula += \"<IDNUMBER>\" + selectedformulaitem.dataset.itemidnumber + \"</IDNUMBER>\";\n            itemformula += \"<GRADEITEMID>\" + selectedformulaitem.dataset.itemid + \"</GRADEITEMID>\";\n\n            //let weightvalue = '';\n            if (selectedformulaitem.dataset.enabled === '1') {\n                itemformula += \"<WEIGHT>\" + selectedformulaitem.value + \"</WEIGHT>\";\n            }\n\n            itemformula += \"</ITEM>\\n\";\n\n            itemsformula += itemformula;\n        });\n\n        let exampleformulas = {\n            \"meangrades\": \"<MEANGRADES>\\n  \" + itemsformula.trim() + \"\\n</MEANGRADES>\",\n            \"weightedmeangrades\": \"<WEIGHTEDMEANGRADES>\\n\" + itemsformula.trim() + \"\\n</WEIGHTEDMEANGRADES>\",\n            \"sum\": \"<SUM>\\n\" + itemsformula.trim() + \"\\n</SUM>\",\n            \"highest\": \"<HIGHEST>\\n\" + itemsformula.trim() + \"\\n</HIGHEST>\",\n            \"lowest\": \"<LOWEST>\\n\" + itemsformula.trim() + \"\\n</LOWEST>\",\n        };\n\n        formulapreviewtextarea.value = exampleformulas[aggregationmethodselect.value];\n    });\n};\n/* END: FUNCTIONS */\n\n\n/* START: EVENT LISTENERS DECLARATION */\n\nexport const init = () => {\n    addEventToCheckbox();\n    aggregationSelection();\n    previewFormula();\n};\n\n/* END: EVENT LISTENERS DECLARATION */"],"names":["selecteditemscheckboxes","document","querySelectorAll","aggregationmethoddiv","querySelector","weightsdefinitiondiv","weightsdefinitiontable","aggregationmethodselect","formulapreviewbox","formulapreviewtextarea","previewformulabutton","getElementById","addEventToCheckbox","i","length","addEventListener","alMenosUnoMarcado","j","checked","classList","remove","value","add","weightenabled","this","newrow","insertRow","innerHTML","dataset","displayname","idnumber","id","weightsdefinitionmatchingrow","aggregationSelection","weightitems","forEach","weightitem","enabled","selectedformulaitems","itemsformula","selectedformulaitem","itemformula","itemdisplayname","itemidnumber","itemid","exampleformulas","trim"],"mappings":"uKAGIA,wBAA0BC,SAASC,iBAAiB,qDAEpDC,qBAAuBF,SAASG,cAAc,sCAC9CC,qBAAuBJ,SAASG,cAAc,sCAC9CE,uBAAyBL,SAASG,cAAc,kDAChDG,wBAA0BN,SAASG,cAAc,6CAGjDI,kBAAoBP,SAASG,cAAc,2BAC3CK,uBAAyBR,SAASG,cAAc,oCAChDM,qBAAuBT,SAASU,eAAe,wCAM7CC,mBAAqB,SAElB,IAAIC,EAAI,EAAGA,EAAIb,wBAAwBc,OAAQD,IAChDb,wBAAwBa,GAAGE,iBAAiB,UAAU,eAK9CC,mBAAoB,MACnB,IAAIC,EAAI,EAAGA,EAAIjB,wBAAwBc,OAAQG,OAC5CjB,wBAAwBiB,GAAGC,QAAS,CACpCF,mBAAoB,QAKxBA,mBACAb,qBAAqBgB,UAAUC,OAAO,gBACA,MAAlCb,wBAAwBc,OACxBhB,qBAAqBc,UAAUC,OAAO,kBAG1CjB,qBAAqBgB,UAAUG,IAAI,gBAEnCjB,qBAAqBc,UAAUG,IAAI,qBAOnCC,cAAgB,MAChBC,KAAKN,QAAS,CAEVK,cADkC,uBAAlChB,wBAAwBc,MACR,IAEA,QAGhBI,OAASnB,uBAAuBoB,WAAW,GAC/CD,OAAOE,UAAY,mBACfH,KAAKI,QAAQC,YADE,6CAKKN,cALL,2BAMaC,KAAKI,QAAQC,YAN1B,wBAOUL,KAAKI,QAAQE,SAPvB,kBAQIN,KAAKI,QAAQG,GARjB,sEAanBN,OAAOG,QAAQG,GAAKP,KAAKI,QAAQG,OAC9B,KACCC,6BAA+B1B,uBAAuBF,cAAc,aAAeoB,KAAKI,QAAQG,GAAK,MACrGC,8BACAA,6BAA6BZ,cAS3Ca,qBAAuB,KACzB1B,wBAAwBQ,iBAAiB,UAAU,WAC5B,MAAfS,KAAKH,MACLhB,qBAAqBc,UAAUG,IAAI,gBAEnCjB,qBAAqBc,UAAUC,OAAO,oBAEtCc,YAAc7B,qBAAqBH,iBAAiB,oCAEhDsB,KAAKH,WACJ,qBACDa,YAAYC,SAAQ,SAASC,YACzBA,WAAWR,QAAQS,QAAU,EAC7BD,WAAWjB,UAAUC,OAAO,6BAG/B,iBACA,UACA,cACA,SACDc,YAAYC,SAAQ,SAASC,YACzBA,WAAWR,QAAQS,QAAU,EAC7BD,WAAWjB,UAAUG,IAAI,sCAmDzB,KAChBV,qBACAqB,uBA3CAvB,qBAAqBK,iBAAiB,SAAS,WAE3CP,kBAAkBW,UAAUC,OAAO,oBAE/BkB,qBAAuBhC,uBAAuBJ,iBAAiB,6BAC/DqC,aAAe,GAEnBD,qBAAqBH,SAAQ,SAAUK,yBAC/BC,YAAc,GAClBA,YAAc,WAEdA,aAAe,gBAAkBD,oBAAoBZ,QAAQc,gBAAkB,iBAC/ED,aAAe,aAAeD,oBAAoBZ,QAAQe,aAAe,cACzEF,aAAe,gBAAkBD,oBAAoBZ,QAAQgB,OAAS,iBAG1B,MAAxCJ,oBAAoBZ,QAAQS,UAC5BI,aAAe,WAAaD,oBAAoBnB,MAAQ,aAG5DoB,aAAe,YAEfF,cAAgBE,mBAGhBI,gBAAkB,YACJ,mBAAqBN,aAAaO,OAAS,qCACnC,yBAA2BP,aAAaO,OAAS,8BAChE,UAAYP,aAAaO,OAAS,mBAC9B,cAAgBP,aAAaO,OAAS,sBACvC,aAAeP,aAAaO,OAAS,eAGnDrC,uBAAuBY,MAAQwB,gBAAgBtC,wBAAwBc"}